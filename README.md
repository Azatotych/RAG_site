# Локальный ассистент (SPA)

React + TypeScript + Vite чат-UI для локального LLM-бэкенда. Сообщения и выбранные документы живут только в памяти вкладки (не сохраняются между перезагрузками). Поддерживаются светлая/тёмная темы с переключателем и запоминанием выбора в `localStorage` (по умолчанию берётся системная тема).

## Возможности v3
- Переключение режимов GPT/RAG в верхней панели. Переключение сбрасывает чат, выбранные документы и закрывает открытые меню/панели.
- RAG режим: выбор литературы через боковой Drawer, дерево разделов из мок-данных, добавление/удаление документов в контексте (лимит 10) и выпадающее меню «Выбранные документы ▾».
- Прогресс-бар «Контекст: N/10» с цветовой индикацией заполнения и красным toast при попытке превысить лимит.
- Обработка ошибок API: после каждого отправленного сообщения сначала добавляется сообщение пользователя, затем — ответ ассистента или красное error-сообщение с причиной и URL.
- Темизация через CSS variables, фон с фирменной подложкой, адаптивная верстка.

## Запуск
```
npm install
npm run dev
```

Сборка:
```
npm run build
```

## Переменные окружения
`.env` или переменные среды:
```
VITE_API_BASE_URL=http://localhost:8080
VITE_CHAT_ENDPOINT=/api/chat
```

### Форматы запросов
`POST ${VITE_API_BASE_URL}${VITE_CHAT_ENDPOINT}`

GPT режим
```json
{
  "mode": "gpt",
  "messages": [{"role":"user","content":"..."}],
  "stream": false
}
```

RAG режим
```json
{
  "mode": "rag",
  "messages": [{"role":"user","content":"..."}],
  "selected_documents": ["doc_id_1", "doc_id_2"],
  "stream": false
}
```

Ответ по умолчанию: `{ "reply": "..." }`.

### Поведение при недоступном API
Если переменные окружения пусты или API не отвечает (ошибка сети/DNS/таймаут, HTTP не 2xx, не-JSON или нет `reply`), приложение продолжит работу: текст пользователя остаётся в ленте, следом выводится красное сообщение об ошибке с причиной и URL.
